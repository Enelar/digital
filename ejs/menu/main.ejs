<nav class="navbar navbar-default" role="navigation">

  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="#">Digital 812</a>
  </div>

  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">
    <%
      var menu =
      {
        left :
        {
          "Главная" : "#",
          "Доставка и оплата" : "#delivery",
          "Гарантия" : "#warranty",
        },
        right :
        {
          "Контакты" : "#contacts",
        }
      };
    %>
    <%= DeferRender('menu/menu', {menu: menu.left}) %>
    </ul>

    <form class="navbar-form navbar-right" role="search">
      <div class="form-group">
        <input type="text" class="form-control" placeholder="Поиск в каталоге">
      </div>
      <button type="submit" class="btn btn-default" style="display: none;"><span class='glyphicon glyphicon-search'></span></button>
    </form>

    <ul class="nav navbar-nav navbar-right">
      <%= DeferRender('menu/menu', {menu: menu.right}) %>
    </ul>
  </div><!-- /.navbar-collapse -->
</nav>

<%

phoxy.Defer(function()
{
  var form = $("#menu form[role='search']");

   // var button = $(this).closest("form").find("button");
  var button = form.find("button");
  var input = form.find("input[type='text']");

  input.on("keyup", function()
  {
    var text = $(this).val();

    button.animate(
    {
      width: text.length == 0 ? 'hide' : 'show'
    });
  });
});
%>
